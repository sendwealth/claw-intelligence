# OpenSpark MVP äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)

**äº§å“åç§°ï¼š** OpenSpark - AI æ™ºèƒ½åŠ©æ‰‹å¹³å°  
**ç‰ˆæœ¬ï¼š** v1.0 MVP  
**æ–‡æ¡£çŠ¶æ€ï¼š** Draft  
**åˆ›å»ºæ—¥æœŸï¼š** 2026-02-26  
**è´Ÿè´£äººï¼š** äº§å“ç»ç†  
**æœ€åæ›´æ–°ï¼š** 2026-02-26  

---

## ğŸ“‹ æ–‡æ¡£ç›®å½•

1. [äº§å“æ¦‚è¿°](#1-äº§å“æ¦‚è¿°)
2. [åŠŸèƒ½éœ€æ±‚](#2-åŠŸèƒ½éœ€æ±‚)
3. [ç”¨æˆ·æµç¨‹è®¾è®¡](#3-ç”¨æˆ·æµç¨‹è®¾è®¡)
4. [API æ¥å£è§„èŒƒ](#4-api-æ¥å£è§„èŒƒ)
5. [éªŒæ”¶æ ‡å‡†](#5-éªŒæ”¶æ ‡å‡†)
6. [æµ‹è¯•ç”¨ä¾‹](#6-æµ‹è¯•ç”¨ä¾‹)
7. [éåŠŸèƒ½æ€§éœ€æ±‚](#7-éåŠŸèƒ½æ€§éœ€æ±‚)
8. [å‘å¸ƒè®¡åˆ’](#8-å‘å¸ƒè®¡åˆ’)

---

## 1. äº§å“æ¦‚è¿°

### 1.1 äº§å“æ„¿æ™¯

OpenSpark æ˜¯ä¸€ä¸ª AI æ™ºèƒ½åŠ©æ‰‹å¹³å°ï¼Œä¸ºä¼ä¸šç”¨æˆ·æä¾›åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½å¯¹è¯æœåŠ¡ï¼Œæ”¯æŒçŸ¥è¯†åº“ç®¡ç†å’Œ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰åŠŸèƒ½ã€‚

### 1.2 ç›®æ ‡ç”¨æˆ·

- **ä¸»è¦ç”¨æˆ·ï¼š** ä¸­å°ä¼ä¸šå‘˜å·¥ã€å›¢é˜Ÿç®¡ç†è€…
- **æ¬¡è¦ç”¨æˆ·ï¼š** ä¸ªäººå¼€å‘è€…ã€è‡ªç”±èŒä¸šè€…
- **ç”¨æˆ·ç”»åƒï¼š**
  - å¹´é¾„ï¼š25-45 å²
  - æŠ€æœ¯æ°´å¹³ï¼šä¸­ç­‰
  - éœ€æ±‚ï¼šæé«˜å·¥ä½œæ•ˆç‡ã€çŸ¥è¯†ç®¡ç†

### 1.3 æ ¸å¿ƒä»·å€¼

- **æ™ºèƒ½å¯¹è¯ï¼š** åŸºäº GLM-4 æ¨¡å‹çš„é«˜è´¨é‡ AI å¯¹è¯
- **çŸ¥è¯†ç®¡ç†ï¼š** æ”¯æŒä¼ä¸šçŸ¥è¯†åº“ä¸Šä¼ å’Œæ£€ç´¢
- **æˆæœ¬é€æ˜ï¼š** Token æ¶ˆè€—å®æ—¶è¿½è¸ª
- **æ˜“äºä½¿ç”¨ï¼š** ç®€æ´ç›´è§‚çš„ç”¨æˆ·ç•Œé¢

### 1.4 MVP ç›®æ ‡

**æ—¶é—´èŒƒå›´ï¼š** 2-3 å‘¨  
**æ ¸å¿ƒç›®æ ‡ï¼š** éªŒè¯æ ¸å¿ƒåŠŸèƒ½ï¼Œè·å–æ—©æœŸç”¨æˆ·åé¦ˆ

**æˆåŠŸæŒ‡æ ‡ï¼š**
- ç”¨æˆ·æ³¨å†Œè½¬åŒ–ç‡ > 30%
- æ—¥æ´»è·ƒç”¨æˆ·ï¼ˆDAUï¼‰> 100
- ç”¨æˆ·ç•™å­˜ç‡ï¼ˆ7å¤©ï¼‰> 40%
- å¹³å‡å¯¹è¯è½®æ¬¡ > 5 æ¬¡/ä¼šè¯

---

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 åŠŸèƒ½ä¼˜å…ˆçº§çŸ©é˜µ

| ä¼˜å…ˆçº§ | åŠŸèƒ½æ¨¡å— | åŠŸèƒ½ç‚¹ | çŠ¶æ€ |
|--------|----------|--------|------|
| **P0** | ç”¨æˆ·è®¤è¯ | ç”¨æˆ·æ³¨å†Œ | âœ… åç«¯å®Œæˆ |
| **P0** | ç”¨æˆ·è®¤è¯ | ç”¨æˆ·ç™»å½• | âœ… åç«¯å®Œæˆ |
| **P0** | AI å¯¹è¯ | åˆ›å»ºå¯¹è¯ | âœ… åç«¯å®Œæˆ |
| **P0** | AI å¯¹è¯ | å‘é€æ¶ˆæ¯ | âœ… åç«¯å®Œæˆ |
| **P0** | AI å¯¹è¯ | AI å›å¤ | âœ… åç«¯å®Œæˆ |
| **P0** | å¯¹è¯ç®¡ç† | æŸ¥çœ‹å†å² | âœ… åç«¯å®Œæˆ |
| **P0** | å¯¹è¯ç®¡ç† | åˆ é™¤å¯¹è¯ | âœ… åç«¯å®Œæˆ |
| **P0** | çŸ¥è¯†åº“ | æ–‡æ¡£ä¸Šä¼  | âŒ å¾…å¼€å‘ |
| **P0** | çŸ¥è¯†åº“ | æ–‡æ¡£åˆ—è¡¨ | âŒ å¾…å¼€å‘ |
| **P0** | çŸ¥è¯†åº“ | è¯­ä¹‰æ£€ç´¢ | âŒ å¾…å¼€å‘ |
| **P1** | ç”¨æˆ·è®¾ç½® | ä¸ªäººèµ„æ–™ | âŒ å¾…å¼€å‘ |
| **P1** | Token è¿½è¸ª | æˆæœ¬ç»Ÿè®¡ | âŒ å¾…å¼€å‘ |
| **P1** | å®æ—¶é€šä¿¡ | WebSocket | âœ… åç«¯å®Œæˆ |
| **P2** | ç”¨æˆ·è®¾ç½® | åå¥½è®¾ç½® | âŒ å¾…å¼€å‘ |
| **P2** | å¯¹è¯ç®¡ç† | å¯¹è¯å¯¼å‡º | âŒ å¾…å¼€å‘ |

---

### 2.2 P0 æ ¸å¿ƒåŠŸèƒ½è¯¦ç»†éœ€æ±‚

#### 2.2.1 ç”¨æˆ·æ³¨å†Œ/ç™»å½•

**åŠŸèƒ½æè¿°ï¼š**
- ç”¨æˆ·é€šè¿‡é‚®ç®±æ³¨å†Œè´¦å·
- é‚®ç®±æ ¼å¼éªŒè¯
- å¯†ç å¼ºåº¦è¦æ±‚ï¼ˆè‡³å°‘ 8 ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—ï¼‰
- å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
- é‚®ç®±éªŒè¯ï¼ˆå¯é€‰ï¼ŒMVP é˜¶æ®µæš‚ä¸å¼ºåˆ¶ï¼‰

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºæ–°ç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æ³¨å†Œè´¦å·ï¼Œä»¥ä¾¿ä½¿ç”¨å¹³å°çš„ AI å¯¹è¯åŠŸèƒ½ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… ç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œæ–°è´¦å·
- âœ… é‚®ç®±é‡å¤æ—¶æ˜¾ç¤ºé”™è¯¯æç¤º
- âœ… å¯†ç å¼ºåº¦ä¸è¶³æ—¶æ˜¾ç¤ºæç¤º
- âœ… æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨ç™»å½•
- âœ… JWT Token æ­£ç¡®è¿”å›

**è¾“å…¥/è¾“å‡ºï¼š**
```json
// è¾“å…¥
{
  "email": "user@example.com",
  "password": "SecurePass123",
  "name": "å¼ ä¸‰"
}

// è¾“å‡º
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "token_type": "bearer",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "å¼ ä¸‰"
  }
}
```

---

#### 2.2.2 AI èŠå¤©å¯¹è¯

**åŠŸèƒ½æè¿°ï¼š**
- åˆ›å»ºæ–°å¯¹è¯ä¼šè¯
- å‘é€ç”¨æˆ·æ¶ˆæ¯
- æ¥æ”¶ AI å›å¤ï¼ˆæµå¼å“åº”ï¼‰
- æ”¯æŒ Markdown æ ¼å¼
- æ˜¾ç¤º Token æ¶ˆè€—

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ä¸ AI è¿›è¡Œå¯¹è¯ï¼Œä»¥ä¾¿è·å–æ™ºèƒ½å›ç­”å’Œå»ºè®®ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… ç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°å¯¹è¯
- âœ… ç”¨æˆ·æ¶ˆæ¯å¯ä»¥æˆåŠŸå‘é€
- âœ… AI å›å¤å®æ—¶æµå¼æ˜¾ç¤º
- âœ… Markdown æ­£ç¡®æ¸²æŸ“
- âœ… Token æ¶ˆè€—æ­£ç¡®è®¡ç®—
- âœ… å¯¹è¯å†å²æ­£ç¡®ä¿å­˜

**æŠ€æœ¯å®ç°ï¼š**
- ä½¿ç”¨ WebSocket å®ç°æµå¼å“åº”
- AI æ¨¡å‹ï¼šGLM-4
- å“åº”æ—¶é—´ï¼š< 3 ç§’é¦–å­—

**è¾“å…¥/è¾“å‡ºï¼š**
```json
// è¾“å…¥
{
  "conversation_id": 1,
  "content": "è¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹"
}

// è¾“å‡ºï¼ˆæµå¼ï¼‰
data: {"content": "äººå·¥", "tokens": 2}
data: {"content": "æ™ºèƒ½", "tokens": 2}
data: {"content": "çš„", "tokens": 1}
data: [DONE]
```

---

#### 2.2.3 å¯¹è¯å†å²ç®¡ç†

**åŠŸèƒ½æè¿°ï¼š**
- æŸ¥çœ‹æ‰€æœ‰å†å²å¯¹è¯
- æŒ‰æ—¶é—´å€’åºæ’åˆ—
- å¯¹è¯æ ‡é¢˜è‡ªåŠ¨ç”Ÿæˆ
- åˆ é™¤å•ä¸ªå¯¹è¯
- æœç´¢å¯¹è¯ï¼ˆå¯é€‰ï¼‰

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æŸ¥çœ‹å†å²å¯¹è¯ï¼Œä»¥ä¾¿å›é¡¾ä¹‹å‰çš„äº¤æµå†…å®¹ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… å¯¹è¯åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º
- âœ… å¯¹è¯æŒ‰æ—¶é—´å€’åºæ’åˆ—
- âœ… å¯¹è¯æ ‡é¢˜å‡†ç¡®ï¼ˆåŸºäºé¦–æ¡æ¶ˆæ¯ç”Ÿæˆï¼‰
- âœ… å¯ä»¥åˆ é™¤å¯¹è¯
- âœ… åˆ é™¤åæ•°æ®ä¸å¯è§

**è¾“å…¥/è¾“å‡ºï¼š**
```json
// è¾“å‡º
{
  "conversations": [
    {
      "id": 1,
      "title": "å…³äºäººå·¥æ™ºèƒ½çš„è®¨è®º",
      "created_at": "2026-02-26T10:00:00Z",
      "message_count": 5
    }
  ],
  "total": 10
}
```

---

#### 2.2.4 çŸ¥è¯†åº“æ–‡æ¡£ä¸Šä¼ 

**åŠŸèƒ½æè¿°ï¼š**
- æ”¯æŒæ–‡ä»¶æ ¼å¼ï¼šPDFã€TXTã€Markdown
- æ–‡ä»¶å¤§å°é™åˆ¶ï¼š10MB
- è‡ªåŠ¨è§£ææ–‡æ¡£å†…å®¹
- æ–‡æ¡£å‘é‡åŒ–å¤„ç†
- æ˜¾ç¤ºä¸Šä¼ è¿›åº¦

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ä¸Šä¼ çŸ¥è¯†æ–‡æ¡£ï¼Œä»¥ä¾¿æ„å»ºä¼ä¸šçŸ¥è¯†åº“ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… æ”¯æŒä¸Šä¼  PDFã€TXTã€MD æ–‡ä»¶
- âœ… æ–‡ä»¶å¤§å°è¶…é™æ—¶æç¤ºé”™è¯¯
- âœ… ä¸Šä¼ è¿›åº¦å®æ—¶æ˜¾ç¤º
- âœ… æ–‡æ¡£å†…å®¹æ­£ç¡®è§£æ
- âœ… å‘é‡åŒ–æˆåŠŸï¼ˆå‘é‡ ID è¿”å›ï¼‰
- âœ… æ–‡æ¡£åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º

**æŠ€æœ¯å®ç°ï¼š**
- å‘é‡æ•°æ®åº“ï¼šQdrant
- Embedding æ¨¡å‹ï¼šæ™ºè°± Embedding API
- æ–‡æ¡£è§£æï¼šPyPDF2ï¼ˆPDFï¼‰ã€å†…ç½®ï¼ˆTXT/MDï¼‰

**è¾“å…¥/è¾“å‡ºï¼š**
```json
// è¾“å…¥
POST /api/knowledge-bases/{kb_id}/documents
Content-Type: multipart/form-data
file: document.pdf

// è¾“å‡º
{
  "id": 1,
  "title": "äº§å“æ‰‹å†Œ.pdf",
  "file_type": "pdf",
  "file_size": 2048576,
  "status": "processing",
  "chunk_count": 0
}
```

---

#### 2.2.5 çŸ¥è¯†åº“æ£€ç´¢

**åŠŸèƒ½æè¿°ï¼š**
- è¯­ä¹‰æ£€ç´¢ç›¸å…³æ–‡æ¡£ç‰‡æ®µ
- æ”¯æŒå…³é”®è¯æ£€ç´¢ï¼ˆå¤‡é€‰ï¼‰
- æ˜¾ç¤ºç›¸å…³æ€§åˆ†æ•°
- æ£€ç´¢ç»“æœé«˜äº®æ˜¾ç¤º

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æ£€ç´¢çŸ¥è¯†åº“ï¼Œä»¥ä¾¿å¿«é€Ÿæ‰¾åˆ°ç›¸å…³ä¿¡æ¯ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… è¯­ä¹‰æ£€ç´¢è¿”å›ç›¸å…³ç»“æœ
- âœ… ç›¸å…³æ€§åˆ†æ•°æ­£ç¡®è®¡ç®—
- âœ… æ£€ç´¢ç»“æœæŒ‰ç›¸å…³æ€§æ’åº
- âœ… æ£€ç´¢é€Ÿåº¦ < 1 ç§’
- âœ… ç»“æœæ•°é‡å¯é…ç½®ï¼ˆé»˜è®¤ Top 5ï¼‰

**æŠ€æœ¯å®ç°ï¼š**
- å‘é‡ç›¸ä¼¼åº¦ï¼šä½™å¼¦ç›¸ä¼¼åº¦
- æ£€ç´¢ç­–ç•¥ï¼šTop-K æ£€ç´¢

**è¾“å…¥/è¾“å‡ºï¼š**
```json
// è¾“å…¥
{
  "knowledge_base_id": 1,
  "query": "äº§å“ä½¿ç”¨æ–¹æ³•",
  "top_k": 5
}

// è¾“å‡º
{
  "results": [
    {
      "document_id": 1,
      "title": "äº§å“æ‰‹å†Œ.pdf",
      "content": "...äº§å“ä½¿ç”¨æ–¹æ³•...",
      "score": 0.89
    }
  ],
  "total": 5
}
```

---

### 2.3 P1 é‡è¦åŠŸèƒ½è¯¦ç»†éœ€æ±‚

#### 2.3.1 Token æˆæœ¬è¿½è¸ª

**åŠŸèƒ½æè¿°ï¼š**
- å®æ—¶æ˜¾ç¤º Token æ¶ˆè€—
- æŒ‰å¯¹è¯ç»Ÿè®¡æˆæœ¬
- æŒ‰æ—¥æœŸç»Ÿè®¡æˆæœ¬
- æˆæœ¬å¯è§†åŒ–å›¾è¡¨

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æŸ¥çœ‹ Token æ¶ˆè€—ï¼Œä»¥ä¾¿æ§åˆ¶ä½¿ç”¨æˆæœ¬ã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… Token æ•°é‡å®æ—¶æ˜¾ç¤º
- âœ… æˆæœ¬é‡‘é¢æ­£ç¡®è®¡ç®—
- âœ… ç»Ÿè®¡æ•°æ®å‡†ç¡®
- âœ… å›¾è¡¨æ­£ç¡®æ¸²æŸ“

**æˆæœ¬è®¡ç®—è§„åˆ™ï¼š**
- GLM-4 è¾“å…¥ï¼šÂ¥0.01 / 1K tokens
- GLM-4 è¾“å‡ºï¼šÂ¥0.01 / 1K tokens

---

#### 2.3.2 ç”¨æˆ·è®¾ç½®

**åŠŸèƒ½æè¿°ï¼š**
- ä¿®æ”¹ä¸ªäººä¿¡æ¯
- ä¿®æ”¹å¯†ç 
- è®¾ç½®åå¥½ï¼ˆè¯­è¨€ã€ä¸»é¢˜ï¼‰
- è´¦å·æ³¨é”€

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ä¿®æ”¹ä¸ªäººè®¾ç½®ï¼Œä»¥ä¾¿ä¸ªæ€§åŒ–ä½¿ç”¨ä½“éªŒã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… ä¸ªäººä¿¡æ¯å¯ä»¥ä¿®æ”¹
- âœ… å¯†ç ä¿®æ”¹éœ€è¦éªŒè¯æ—§å¯†ç 
- âœ… è®¾ç½®æ›´æ”¹ç«‹å³ç”Ÿæ•ˆ

---

#### 2.3.3 WebSocket å®æ—¶é€šä¿¡

**åŠŸèƒ½æè¿°ï¼š**
- å®æ—¶æ¥æ”¶ AI æµå¼å›å¤
- å®æ—¶æ¨é€ç³»ç»Ÿé€šçŸ¥
- è¿æ¥çŠ¶æ€ç®¡ç†

**ç”¨æˆ·æ•…äº‹ï¼š**
> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦å®æ—¶çœ‹åˆ° AI å›å¤ï¼Œä»¥ä¾¿è·å¾—æµç•…çš„å¯¹è¯ä½“éªŒã€‚

**éªŒæ”¶æ ‡å‡†ï¼š**
- âœ… WebSocket è¿æ¥ç¨³å®š
- âœ… æ¶ˆæ¯å®æ—¶æ¨é€
- âœ… æ–­çº¿è‡ªåŠ¨é‡è¿
- âœ… å¿ƒè·³æœºåˆ¶æ­£å¸¸

---

### 2.4 P2 æ¬¡è¦åŠŸèƒ½ï¼ˆMVP åæœŸï¼‰

- å¯¹è¯å¯¼å‡ºï¼ˆPDFã€Markdownï¼‰
- å¯¹è¯åˆ†äº«
- å¤šè¯­è¨€æ”¯æŒ
- æš—è‰²ä¸»é¢˜
- å¿«æ·é”®æ”¯æŒ

---

## 3. ç”¨æˆ·æµç¨‹è®¾è®¡

### 3.1 ç”¨æˆ·æ³¨å†Œ/ç™»å½•æµç¨‹

```mermaid
graph TD
    A[è®¿é—®é¦–é¡µ] --> B{å·²ç™»å½•?}
    B -->|å¦| C[ç‚¹å‡»æ³¨å†Œ]
    B -->|æ˜¯| D[è¿›å…¥ä¸»é¡µ]
    C --> E[å¡«å†™é‚®ç®±å¯†ç ]
    E --> F{é‚®ç®±å·²å­˜åœ¨?}
    F -->|æ˜¯| G[æç¤ºé‚®ç®±å·²æ³¨å†Œ]
    F -->|å¦| H{å¯†ç å¼ºåº¦è¶³å¤Ÿ?}
    H -->|å¦| I[æç¤ºå¯†ç å¼ºåº¦ä¸è¶³]
    H -->|æ˜¯| J[æäº¤æ³¨å†Œ]
    J --> K[åˆ›å»ºè´¦å·]
    K --> L[è‡ªåŠ¨ç™»å½•]
    L --> D
    G --> E
    I --> E
```

**é¡µé¢æµè½¬ï¼š**
1. é¦–é¡µ â†’ æ³¨å†Œé¡µï¼ˆ/registerï¼‰
2. å¡«å†™è¡¨å• â†’ æäº¤
3. æˆåŠŸ â†’ ä¸»é¡µï¼ˆ/dashboardï¼‰
4. å¤±è´¥ â†’ æ˜¾ç¤ºé”™è¯¯ â†’ é‡æ–°å¡«å†™

**è¡¨å•å­—æ®µï¼š**
- é‚®ç®±ï¼ˆå¿…å¡«ï¼ŒéªŒè¯æ ¼å¼ï¼‰
- å¯†ç ï¼ˆå¿…å¡«ï¼Œå¼ºåº¦éªŒè¯ï¼‰
- å§“åï¼ˆå¯é€‰ï¼‰
- å…¬å¸åç§°ï¼ˆå¯é€‰ï¼‰

---

### 3.2 AI èŠå¤©æµç¨‹

```mermaid
graph TD
    A[è¿›å…¥ä¸»é¡µ] --> B[é€‰æ‹©æˆ–åˆ›å»ºå¯¹è¯]
    B --> C[è¾“å…¥æ¶ˆæ¯]
    C --> D[å‘é€æ¶ˆæ¯]
    D --> E[æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯]
    E --> F[è°ƒç”¨ AI API]
    F --> G[æµå¼è¿”å› AI å›å¤]
    G --> H[å®æ—¶æ˜¾ç¤ºå›å¤]
    H --> I{å¯¹è¯ç»§ç»­?}
    I -->|æ˜¯| C
    I -->|å¦| J[ç»“æŸå¯¹è¯]
    J --> K[ä¿å­˜å¯¹è¯å†å²]
```

**äº¤äº’ç»†èŠ‚ï¼š**
1. **è¾“å…¥æ¡†ï¼š**
   - æ”¯æŒ Shift+Enter æ¢è¡Œ
   - Enter å‘é€æ¶ˆæ¯
   - å‘é€æ—¶ç¦ç”¨è¾“å…¥æ¡†
   - æ˜¾ç¤º"æ­£åœ¨è¾“å…¥..."çŠ¶æ€

2. **æ¶ˆæ¯æ˜¾ç¤ºï¼š**
   - ç”¨æˆ·æ¶ˆæ¯ï¼šå³ä¾§å¯¹é½ï¼Œè“è‰²èƒŒæ™¯
   - AI æ¶ˆæ¯ï¼šå·¦ä¾§å¯¹é½ï¼Œç°è‰²èƒŒæ™¯
   - æ”¯æŒ Markdown æ¸²æŸ“
   - æ˜¾ç¤ºæ—¶é—´æˆ³

3. **æµå¼å“åº”ï¼š**
   - é€å­—æ˜¾ç¤º
   - å…‰æ ‡é—ªçƒæ•ˆæœ
   - æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯

---

### 3.3 çŸ¥è¯†åº“ç®¡ç†æµç¨‹

```mermaid
graph TD
    A[è¿›å…¥çŸ¥è¯†åº“é¡µé¢] --> B[ç‚¹å‡»ä¸Šä¼ æ–‡æ¡£]
    B --> C[é€‰æ‹©æ–‡ä»¶]
    C --> D{æ–‡ä»¶æ ¼å¼æ­£ç¡®?}
    D -->|å¦| E[æç¤ºæ ¼å¼é”™è¯¯]
    D -->|æ˜¯| F{æ–‡ä»¶å¤§å° â‰¤ 10MB?}
    F -->|å¦| G[æç¤ºæ–‡ä»¶è¿‡å¤§]
    F -->|æ˜¯| H[å¼€å§‹ä¸Šä¼ ]
    H --> I[æ˜¾ç¤ºä¸Šä¼ è¿›åº¦]
    I --> J[è§£ææ–‡æ¡£å†…å®¹]
    J --> K[æ–‡æ¡£å‘é‡åŒ–]
    K --> L[ä¿å­˜åˆ°æ•°æ®åº“]
    L --> M[æ›´æ–°æ–‡æ¡£åˆ—è¡¨]
    E --> C
    G --> C
```

**é¡µé¢å…ƒç´ ï¼š**
1. **çŸ¥è¯†åº“åˆ—è¡¨ï¼š**
   - çŸ¥è¯†åº“åç§°
   - æ–‡æ¡£æ•°é‡
   - åˆ›å»ºæ—¶é—´
   - æ“ä½œæŒ‰é’®ï¼ˆæŸ¥çœ‹ã€åˆ é™¤ï¼‰

2. **ä¸Šä¼ åŒºåŸŸï¼š**
   - æ‹–æ‹½ä¸Šä¼ 
   - ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
   - è¿›åº¦æ¡æ˜¾ç¤º

3. **æ–‡æ¡£åˆ—è¡¨ï¼š**
   - æ–‡æ¡£æ ‡é¢˜
   - æ–‡ä»¶ç±»å‹å›¾æ ‡
   - æ–‡ä»¶å¤§å°
   - ä¸Šä¼ æ—¶é—´
   - çŠ¶æ€ï¼ˆå¤„ç†ä¸­/å·²å®Œæˆ/å¤±è´¥ï¼‰

---

### 3.4 çŸ¥è¯†åº“æ£€ç´¢æµç¨‹

```mermaid
graph TD
    A[è¿›å…¥çŸ¥è¯†åº“] --> B[è¾“å…¥æ£€ç´¢å…³é”®è¯]
    B --> C[ç‚¹å‡»æ£€ç´¢]
    C --> D[è¯­ä¹‰å‘é‡åŒ–]
    D --> E[å‘é‡ç›¸ä¼¼åº¦è®¡ç®—]
    E --> F[è¿”å› Top-K ç»“æœ]
    F --> G[æ˜¾ç¤ºæ£€ç´¢ç»“æœ]
    G --> H{ç‚¹å‡»ç»“æœ?}
    H -->|æ˜¯| I[æŸ¥çœ‹æ–‡æ¡£è¯¦æƒ…]
    H -->|å¦| J[ç»§ç»­æ£€ç´¢]
    J --> B
```

**æ£€ç´¢ç•Œé¢ï¼š**
1. **æœç´¢æ¡†ï¼š**
   - å®æ—¶æœç´¢å»ºè®®ï¼ˆå¯é€‰ï¼‰
   - æœç´¢å†å²è®°å½•ï¼ˆå¯é€‰ï¼‰

2. **ç»“æœå±•ç¤ºï¼š**
   - ç›¸å…³æ€§åˆ†æ•°ï¼ˆç™¾åˆ†æ¯”ï¼‰
   - æ–‡æ¡£ç‰‡æ®µé¢„è§ˆ
   - é«˜äº®å…³é”®è¯
   - æŸ¥çœ‹åŸæ–‡é“¾æ¥

3. **ç­›é€‰é€‰é¡¹ï¼š**
   - æŒ‰æ–‡æ¡£ç±»å‹ç­›é€‰
   - æŒ‰æ—¶é—´èŒƒå›´ç­›é€‰

---

### 3.5 ç”¨æˆ·æµç¨‹å›¾ï¼ˆå®Œæ•´ï¼‰

```mermaid
graph TD
    Start[è®¿é—®ç½‘ç«™] --> Login{å·²ç™»å½•?}
    Login -->|å¦| Register[æ³¨å†Œ/ç™»å½•]
    Login -->|æ˜¯| Dashboard[è¿›å…¥ä¸»é¡µ]
    Register --> Dashboard
    
    Dashboard --> Chat[AI å¯¹è¯]
    Dashboard --> Knowledge[çŸ¥è¯†åº“]
    Dashboard --> Settings[ä¸ªäººè®¾ç½®]
    Dashboard --> History[å†å²å¯¹è¯]
    
    Chat --> NewChat[åˆ›å»ºæ–°å¯¹è¯]
    NewChat --> SendMessage[å‘é€æ¶ˆæ¯]
    SendMessage --> ReceiveReply[æ¥æ”¶ AI å›å¤]
    ReceiveReply --> ContinueOrEnd{ç»§ç»­å¯¹è¯?}
    ContinueOrEnd -->|æ˜¯| SendMessage
    ContinueOrEnd -->|å¦| SaveChat[ä¿å­˜å¯¹è¯]
    SaveChat --> Dashboard
    
    Knowledge --> UploadDoc[ä¸Šä¼ æ–‡æ¡£]
    UploadDoc --> ProcessDoc[å¤„ç†æ–‡æ¡£]
    ProcessDoc --> SearchDoc[æ£€ç´¢æ–‡æ¡£]
    SearchDoc --> ViewResult[æŸ¥çœ‹ç»“æœ]
    ViewResult --> Dashboard
    
    Settings --> UpdateProfile[ä¿®æ”¹èµ„æ–™]
    Settings --> ChangePassword[ä¿®æ”¹å¯†ç ]
    Settings --> Preferences[åå¥½è®¾ç½®]
    
    History --> ViewHistory[æŸ¥çœ‹å†å²]
    ViewHistory --> DeleteChat[åˆ é™¤å¯¹è¯]
    ViewHistory --> ResumeChat[ç»§ç»­å¯¹è¯]
    ResumeChat --> SendMessage
```

---

## 4. API æ¥å£è§„èŒƒ

### 4.1 æ¥å£åŸºç¡€ä¿¡æ¯

**Base URL:** `https://api.openspark.ai/v1`  
**è®¤è¯æ–¹å¼:** Bearer Token (JWT)  
**è¯·æ±‚æ ¼å¼:** JSON  
**å“åº”æ ¼å¼:** JSON  

**é€šç”¨å“åº”ç»“æ„:**
```json
{
  "success": true,
  "data": {},
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2026-02-26T10:00:00Z"
}
```

**é€šç”¨é”™è¯¯å“åº”:**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
    "details": {}
  },
  "timestamp": "2026-02-26T10:00:00Z"
}
```

---

### 4.2 è®¤è¯æ¥å£

#### 4.2.1 ç”¨æˆ·æ³¨å†Œ

**æ¥å£:** `POST /auth/register`

**è¯·æ±‚å‚æ•°:**
```json
{
  "email": "user@example.com",
  "password": "SecurePass123",
  "name": "å¼ ä¸‰",
  "company": "ABCå…¬å¸"
}
```

**å“åº”å‚æ•°:**
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "token_type": "bearer",
  "expires_in": 3600,
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "å¼ ä¸‰",
    "company": "ABCå…¬å¸",
    "created_at": "2026-02-26T10:00:00Z"
  }
}
```

**é”™è¯¯ç :**
- `EMAIL_EXISTS` - é‚®ç®±å·²æ³¨å†Œ
- `INVALID_EMAIL` - é‚®ç®±æ ¼å¼é”™è¯¯
- `WEAK_PASSWORD` - å¯†ç å¼ºåº¦ä¸è¶³
- `MISSING_FIELD` - å¿…å¡«å­—æ®µç¼ºå¤±

---

#### 4.2.2 ç”¨æˆ·ç™»å½•

**æ¥å£:** `POST /auth/login`

**è¯·æ±‚å‚æ•°:**
```json
{
  "email": "user@example.com",
  "password": "SecurePass123"
}
```

**å“åº”å‚æ•°:** åŒæ³¨å†Œæ¥å£

**é”™è¯¯ç :**
- `INVALID_CREDENTIALS` - é‚®ç®±æˆ–å¯†ç é”™è¯¯
- `ACCOUNT_INACTIVE` - è´¦å·æœªæ¿€æ´»
- `TOO_MANY_ATTEMPTS` - ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤š

---

#### 4.2.3 åˆ·æ–° Token

**æ¥å£:** `POST /auth/refresh`

**è¯·æ±‚å‚æ•°:**
```json
{
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

**å“åº”å‚æ•°:**
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "token_type": "bearer",
  "expires_in": 3600
}
```

---

### 4.3 å¯¹è¯æ¥å£

#### 4.3.1 åˆ›å»ºå¯¹è¯

**æ¥å£:** `POST /conversations`

**è¯·æ±‚å¤´:**
```
Authorization: Bearer {access_token}
```

**è¯·æ±‚å‚æ•°:**
```json
{
  "title": "å…³äº AI çš„è®¨è®º",
  "model": "glm-4",
  "system_prompt": "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„ AI åŠ©æ‰‹"
}
```

**å“åº”å‚æ•°:**
```json
{
  "id": 1,
  "title": "å…³äº AI çš„è®¨è®º",
  "model": "glm-4",
  "status": "active",
  "created_at": "2026-02-26T10:00:00Z"
}
```

---

#### 4.3.2 å‘é€æ¶ˆæ¯

**æ¥å£:** `POST /conversations/{conversation_id}/messages`

**è¯·æ±‚å‚æ•°:**
```json
{
  "content": "è¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹",
  "stream": true
}
```

**å“åº”å‚æ•°ï¼ˆéæµå¼ï¼‰:**
```json
{
  "id": 1,
  "role": "user",
  "content": "è¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹",
  "tokens": 15,
  "created_at": "2026-02-26T10:00:00Z"
}
```

**å“åº”å‚æ•°ï¼ˆæµå¼ï¼‰:**
```
data: {"content": "äººå·¥", "tokens": 2}
data: {"content": "æ™ºèƒ½", "tokens": 2}
data: {"content": "çš„", "tokens": 1}
data: [DONE]
```

---

#### 4.3.3 è·å–å¯¹è¯åˆ—è¡¨

**æ¥å£:** `GET /conversations`

**æŸ¥è¯¢å‚æ•°:**
- `page` - é¡µç ï¼ˆé»˜è®¤ 1ï¼‰
- `page_size` - æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ 20ï¼‰
- `status` - å¯¹è¯çŠ¶æ€ï¼ˆå¯é€‰ï¼‰

**å“åº”å‚æ•°:**
```json
{
  "conversations": [
    {
      "id": 1,
      "title": "å…³äº AI çš„è®¨è®º",
      "status": "active",
      "message_count": 5,
      "created_at": "2026-02-26T10:00:00Z",
      "updated_at": "2026-02-26T11:00:00Z"
    }
  ],
  "total": 10,
  "page": 1,
  "page_size": 20
}
```

---

#### 4.3.4 è·å–å¯¹è¯è¯¦æƒ…

**æ¥å£:** `GET /conversations/{conversation_id}`

**å“åº”å‚æ•°:**
```json
{
  "id": 1,
  "title": "å…³äº AI çš„è®¨è®º",
  "model": "glm-4",
  "status": "active",
  "messages": [
    {
      "id": 1,
      "role": "user",
      "content": "è¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½",
      "tokens": 10,
      "created_at": "2026-02-26T10:00:00Z"
    },
    {
      "id": 2,
      "role": "assistant",
      "content": "äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰æ˜¯...",
      "tokens": 150,
      "created_at": "2026-02-26T10:00:05Z"
    }
  ],
  "total_tokens": 160,
  "total_cost": 0.0016,
  "created_at": "2026-02-26T10:00:00Z"
}
```

---

#### 4.3.5 åˆ é™¤å¯¹è¯

**æ¥å£:** `DELETE /conversations/{conversation_id}`

**å“åº”å‚æ•°:**
```json
{
  "success": true,
  "message": "å¯¹è¯å·²åˆ é™¤"
}
```

---

### 4.4 çŸ¥è¯†åº“æ¥å£

#### 4.4.1 åˆ›å»ºçŸ¥è¯†åº“

**æ¥å£:** `POST /knowledge-bases`

**è¯·æ±‚å‚æ•°:**
```json
{
  "name": "äº§å“æ–‡æ¡£åº“",
  "description": "å­˜å‚¨äº§å“ç›¸å…³æ–‡æ¡£"
}
```

**å“åº”å‚æ•°:**
```json
{
  "id": 1,
  "name": "äº§å“æ–‡æ¡£åº“",
  "description": "å­˜å‚¨äº§å“ç›¸å…³æ–‡æ¡£",
  "document_count": 0,
  "created_at": "2026-02-26T10:00:00Z"
}
```

---

#### 4.4.2 ä¸Šä¼ æ–‡æ¡£

**æ¥å£:** `POST /knowledge-bases/{kb_id}/documents`

**è¯·æ±‚å¤´:**
```
Content-Type: multipart/form-data
```

**è¯·æ±‚å‚æ•°:**
- `file` - æ–‡æ¡£æ–‡ä»¶ï¼ˆPDF/TXT/MDï¼‰

**å“åº”å‚æ•°:**
```json
{
  "id": 1,
  "title": "äº§å“æ‰‹å†Œ.pdf",
  "file_type": "pdf",
  "file_size": 2048576,
  "status": "processing",
  "chunk_count": 0,
  "created_at": "2026-02-26T10:00:00Z"
}
```

---

#### 4.4.3 è·å–æ–‡æ¡£åˆ—è¡¨

**æ¥å£:** `GET /knowledge-bases/{kb_id}/documents`

**å“åº”å‚æ•°:**
```json
{
  "documents": [
    {
      "id": 1,
      "title": "äº§å“æ‰‹å†Œ.pdf",
      "file_type": "pdf",
      "file_size": 2048576,
      "status": "completed",
      "chunk_count": 15,
      "created_at": "2026-02-26T10:00:00Z"
    }
  ],
  "total": 5
}
```

---

#### 4.4.4 çŸ¥è¯†åº“æ£€ç´¢

**æ¥å£:** `POST /knowledge-bases/{kb_id}/search`

**è¯·æ±‚å‚æ•°:**
```json
{
  "query": "äº§å“ä½¿ç”¨æ–¹æ³•",
  "top_k": 5
}
```

**å“åº”å‚æ•°:**
```json
{
  "results": [
    {
      "document_id": 1,
      "title": "äº§å“æ‰‹å†Œ.pdf",
      "content": "...äº§å“ä½¿ç”¨æ–¹æ³•...",
      "score": 0.89,
      "chunk_index": 3
    }
  ],
  "query": "äº§å“ä½¿ç”¨æ–¹æ³•",
  "total": 5
}
```

---

#### 4.4.5 åˆ é™¤æ–‡æ¡£

**æ¥å£:** `DELETE /knowledge-bases/{kb_id}/documents/{doc_id}`

**å“åº”å‚æ•°:**
```json
{
  "success": true,
  "message": "æ–‡æ¡£å·²åˆ é™¤"
}
```

---

### 4.5 ç”¨æˆ·è®¾ç½®æ¥å£

#### 4.5.1 è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£:** `GET /users/me`

**å“åº”å‚æ•°:**
```json
{
  "id": 1,
  "email": "user@example.com",
  "name": "å¼ ä¸‰",
  "company": "ABCå…¬å¸",
  "subscription_tier": "free",
  "created_at": "2026-02-26T10:00:00Z"
}
```

---

#### 4.5.2 æ›´æ–°ç”¨æˆ·ä¿¡æ¯

**æ¥å£:** `PUT /users/me`

**è¯·æ±‚å‚æ•°:**
```json
{
  "name": "æå››",
  "company": "XYZå…¬å¸"
}
```

**å“åº”å‚æ•°:**
```json
{
  "success": true,
  "user": {
    "id": 1,
    "name": "æå››",
    "company": "XYZå…¬å¸"
  }
}
```

---

#### 4.5.3 ä¿®æ”¹å¯†ç 

**æ¥å£:** `PUT /users/me/password`

**è¯·æ±‚å‚æ•°:**
```json
{
  "old_password": "OldPass123",
  "new_password": "NewPass456"
}
```

**å“åº”å‚æ•°:**
```json
{
  "success": true,
  "message": "å¯†ç å·²æ›´æ–°"
}
```

---

### 4.6 ç»Ÿè®¡æ¥å£

#### 4.6.1 Token æ¶ˆè€—ç»Ÿè®¡

**æ¥å£:** `GET /stats/tokens`

**æŸ¥è¯¢å‚æ•°:**
- `start_date` - å¼€å§‹æ—¥æœŸ
- `end_date` - ç»“æŸæ—¥æœŸ
- `conversation_id` - å¯¹è¯ IDï¼ˆå¯é€‰ï¼‰

**å“åº”å‚æ•°:**
```json
{
  "total_tokens": 10000,
  "input_tokens": 6000,
  "output_tokens": 4000,
  "total_cost": 0.1,
  "daily_stats": [
    {
      "date": "2026-02-26",
      "tokens": 2000,
      "cost": 0.02
    }
  ]
}
```

---

### 4.7 é”™è¯¯ç å®šä¹‰

| é”™è¯¯ç  | HTTP çŠ¶æ€ç  | è¯´æ˜ |
|--------|-------------|------|
| `VALIDATION_ERROR` | 400 | å‚æ•°éªŒè¯å¤±è´¥ |
| `UNAUTHORIZED` | 401 | æœªæˆæƒ |
| `FORBIDDEN` | 403 | æ— æƒé™ |
| `NOT_FOUND` | 404 | èµ„æºä¸å­˜åœ¨ |
| `CONFLICT` | 409 | èµ„æºå†²çª |
| `RATE_LIMIT` | 429 | è¯·æ±‚é¢‘ç‡è¶…é™ |
| `INTERNAL_ERROR` | 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
| `SERVICE_UNAVAILABLE` | 503 | æœåŠ¡ä¸å¯ç”¨ |

---

### 4.8 WebSocket æ¥å£

**è¿æ¥åœ°å€:** `wss://api.openspark.ai/ws`

**è¿æ¥å‚æ•°:**
```
wss://api.openspark.ai/ws?token={access_token}
```

**æ¶ˆæ¯æ ¼å¼:**
```json
{
  "type": "message",
  "conversation_id": 1,
  "content": "ç”¨æˆ·æ¶ˆæ¯å†…å®¹"
}
```

**å“åº”æ ¼å¼:**
```json
{
  "type": "stream",
  "conversation_id": 1,
  "content": "AI",
  "tokens": 1
}
```

**å¿ƒè·³æœºåˆ¶:**
- å®¢æˆ·ç«¯æ¯ 30 ç§’å‘é€ `{"type": "ping"}`
- æœåŠ¡ç«¯å“åº” `{"type": "pong"}`

---

## 5. éªŒæ”¶æ ‡å‡†

### 5.1 P0 æ ¸å¿ƒåŠŸèƒ½éªŒæ”¶æ ‡å‡†

#### 5.1.1 ç”¨æˆ·æ³¨å†Œ/ç™»å½•

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| æ³¨å†ŒæˆåŠŸç‡ | 100% | åŠŸèƒ½æµ‹è¯• |
| é‚®ç®±éªŒè¯ | æ­£ç¡®è¯†åˆ«é‡å¤é‚®ç®± | é›†æˆæµ‹è¯• |
| å¯†ç å¼ºåº¦ | æ‹’ç»å¼±å¯†ç  | å•å…ƒæµ‹è¯• |
| Token ç”Ÿæˆ | JWT æ ¼å¼æ­£ç¡® | å•å…ƒæµ‹è¯• |
| å“åº”æ—¶é—´ | < 500ms | æ€§èƒ½æµ‹è¯• |

#### 5.1.2 AI èŠå¤©å¯¹è¯

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| æ¶ˆæ¯å‘é€ | 100% æˆåŠŸ | åŠŸèƒ½æµ‹è¯• |
| AI å›å¤ | å†…å®¹ç›¸å…³ã€æ ¼å¼æ­£ç¡® | äººå·¥è¯„å®¡ |
| æµå¼å“åº” | é¦–å­— < 3 ç§’ | æ€§èƒ½æµ‹è¯• |
| Token è®¡ç®— | è¯¯å·® < 5% | å•å…ƒæµ‹è¯• |
| å¯¹è¯ä¿å­˜ | å†å²å®Œæ•´ | é›†æˆæµ‹è¯• |

#### 5.1.3 å¯¹è¯å†å²ç®¡ç†

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| åˆ—è¡¨æ˜¾ç¤º | æ­£ç¡®æ’åºã€åˆ†é¡µ | åŠŸèƒ½æµ‹è¯• |
| åˆ é™¤åŠŸèƒ½ | æ•°æ®å®Œå…¨åˆ é™¤ | é›†æˆæµ‹è¯• |
| æœç´¢åŠŸèƒ½ | ç»“æœå‡†ç¡®ï¼ˆå¦‚å®ç°ï¼‰ | åŠŸèƒ½æµ‹è¯• |
| å“åº”æ—¶é—´ | < 300ms | æ€§èƒ½æµ‹è¯• |

#### 5.1.4 çŸ¥è¯†åº“æ–‡æ¡£ä¸Šä¼ 

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| æ–‡ä»¶æ ¼å¼ | æ”¯æŒ PDF/TXT/MD | åŠŸèƒ½æµ‹è¯• |
| æ–‡ä»¶å¤§å° | æ‹’ç» > 10MB | è¾¹ç•Œæµ‹è¯• |
| ä¸Šä¼ è¿›åº¦ | å®æ—¶æ˜¾ç¤º | åŠŸèƒ½æµ‹è¯• |
| æ–‡æ¡£è§£æ | å†…å®¹æå–å‡†ç¡® | äººå·¥è¯„å®¡ |
| å‘é‡åŒ– | å‘é‡ ID ç”ŸæˆæˆåŠŸ | é›†æˆæµ‹è¯• |

#### 5.1.5 çŸ¥è¯†åº“æ£€ç´¢

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| è¯­ä¹‰æ£€ç´¢ | ç›¸å…³æ€§ > 80% | äººå·¥è¯„å®¡ |
| æ£€ç´¢é€Ÿåº¦ | < 1 ç§’ | æ€§èƒ½æµ‹è¯• |
| ç»“æœæ’åº | æŒ‰ç›¸å…³æ€§é™åº | åŠŸèƒ½æµ‹è¯• |
| ç»“æœæ•°é‡ | å¯é…ç½® Top-K | åŠŸèƒ½æµ‹è¯• |

---

### 5.2 P1 é‡è¦åŠŸèƒ½éªŒæ”¶æ ‡å‡†

#### 5.2.1 Token æˆæœ¬è¿½è¸ª

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| å®æ—¶ç»Ÿè®¡ | æ•°æ®å‡†ç¡® | å•å…ƒæµ‹è¯• |
| æˆæœ¬è®¡ç®— | é‡‘é¢æ­£ç¡® | å•å…ƒæµ‹è¯• |
| å›¾è¡¨æ˜¾ç¤º | æ­£ç¡®æ¸²æŸ“ | åŠŸèƒ½æµ‹è¯• |

#### 5.2.2 ç”¨æˆ·è®¾ç½®

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| ä¿¡æ¯ä¿®æ”¹ | æˆåŠŸæ›´æ–° | åŠŸèƒ½æµ‹è¯• |
| å¯†ç ä¿®æ”¹ | éœ€éªŒè¯æ—§å¯†ç  | åŠŸèƒ½æµ‹è¯• |
| è®¾ç½®ç”Ÿæ•ˆ | ç«‹å³ç”Ÿæ•ˆ | åŠŸèƒ½æµ‹è¯• |

#### 5.2.3 WebSocket å®æ—¶é€šä¿¡

| éªŒæ”¶é¡¹ | æ ‡å‡† | æµ‹è¯•æ–¹æ³• |
|--------|------|----------|
| è¿æ¥ç¨³å®šæ€§ | 99.9% å¯ç”¨ | å‹åŠ›æµ‹è¯• |
| æ¶ˆæ¯æ¨é€ | å®æ—¶åˆ°è¾¾ | åŠŸèƒ½æµ‹è¯• |
| æ–­çº¿é‡è¿ | è‡ªåŠ¨é‡è¿ | åŠŸèƒ½æµ‹è¯• |
| å¿ƒè·³æœºåˆ¶ | 30 ç§’é—´éš” | åŠŸèƒ½æµ‹è¯• |

---

### 5.3 æ•´ä½“éªŒæ”¶æ ‡å‡†

#### 5.3.1 åŠŸèƒ½å®Œæ•´æ€§

- âœ… æ‰€æœ‰ P0 åŠŸèƒ½ 100% å®Œæˆ
- âœ… æ‰€æœ‰ P1 åŠŸèƒ½ 80% å®Œæˆ
- âœ… P2 åŠŸèƒ½å¯å»¶å

#### 5.3.2 æ€§èƒ½æ ‡å‡†

| æŒ‡æ ‡ | æ ‡å‡† |
|------|------|
| é¡µé¢åŠ è½½æ—¶é—´ | < 2 ç§’ |
| API å“åº”æ—¶é—´ | P95 < 500ms |
| AI é¦–å­—å“åº” | < 3 ç§’ |
| å¹¶å‘ç”¨æˆ·æ•° | > 100 |

#### 5.3.3 è´¨é‡æ ‡å‡†

| æŒ‡æ ‡ | æ ‡å‡† |
|------|------|
| æµ‹è¯•è¦†ç›–ç‡ | > 70% |
| Bug ä¸¥é‡ç‡ | P0 Bug = 0 |
| ä»£ç è§„èŒƒ | é€šè¿‡ Lint æ£€æŸ¥ |
| æ–‡æ¡£å®Œæ•´æ€§ | 100% |

#### 5.3.4 ç”¨æˆ·ä½“éªŒæ ‡å‡†

| æŒ‡æ ‡ | æ ‡å‡† |
|------|------|
| ç•Œé¢ç¾è§‚åº¦ | è®¾è®¡è¯„å®¡é€šè¿‡ |
| äº¤äº’æµç•…åº¦ | æ— æ˜æ˜¾å¡é¡¿ |
| é”™è¯¯æç¤º | æ¸…æ™°å‹å¥½ |
| å“åº”å¼è®¾è®¡ | æ”¯æŒç§»åŠ¨ç«¯ |

---

## 6. æµ‹è¯•ç”¨ä¾‹

### 6.1 ç”¨æˆ·è®¤è¯æµ‹è¯•ç”¨ä¾‹

#### TC-AUTH-001: ç”¨æˆ·æ³¨å†ŒæˆåŠŸ

**å‰ç½®æ¡ä»¶:** æ—   
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®æ³¨å†Œé¡µé¢
2. è¾“å…¥é‚®ç®±: `test@example.com`
3. è¾“å…¥å¯†ç : `SecurePass123`
4. è¾“å…¥å§“å: `æµ‹è¯•ç”¨æˆ·`
5. ç‚¹å‡»æ³¨å†ŒæŒ‰é’®

**é¢„æœŸç»“æœ:**
- æ³¨å†ŒæˆåŠŸ
- è‡ªåŠ¨ç™»å½•
- è·³è½¬åˆ°ä¸»é¡µ
- Token æ­£ç¡®è¿”å›

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-AUTH-002: é‚®ç®±å·²å­˜åœ¨

**å‰ç½®æ¡ä»¶:** é‚®ç®± `test@example.com` å·²æ³¨å†Œ  
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®æ³¨å†Œé¡µé¢
2. è¾“å…¥é‚®ç®±: `test@example.com`
3. è¾“å…¥å¯†ç : `AnotherPass456`
4. ç‚¹å‡»æ³¨å†ŒæŒ‰é’®

**é¢„æœŸç»“æœ:**
- æ˜¾ç¤ºé”™è¯¯: "é‚®ç®±å·²è¢«æ³¨å†Œ"
- ä¿æŒåœ¨æ³¨å†Œé¡µé¢

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-AUTH-003: å¯†ç å¼ºåº¦ä¸è¶³

**å‰ç½®æ¡ä»¶:** æ—   
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®æ³¨å†Œé¡µé¢
2. è¾“å…¥é‚®ç®±: `test2@example.com`
3. è¾“å…¥å¯†ç : `123`ï¼ˆå¼±å¯†ç ï¼‰
4. ç‚¹å‡»æ³¨å†ŒæŒ‰é’®

**é¢„æœŸç»“æœ:**
- æ˜¾ç¤ºé”™è¯¯: "å¯†ç å¼ºåº¦ä¸è¶³ï¼Œè‡³å°‘ 8 ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—"
- ä¿æŒåœ¨æ³¨å†Œé¡µé¢

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-AUTH-004: ç”¨æˆ·ç™»å½•æˆåŠŸ

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·å·²æ³¨å†Œ  
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®ç™»å½•é¡µé¢
2. è¾“å…¥é‚®ç®±: `test@example.com`
3. è¾“å…¥å¯†ç : `SecurePass123`
4. ç‚¹å‡»ç™»å½•æŒ‰é’®

**é¢„æœŸç»“æœ:**
- ç™»å½•æˆåŠŸ
- è·³è½¬åˆ°ä¸»é¡µ
- Token æ­£ç¡®è¿”å›

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-AUTH-005: ç™»å½•å¤±è´¥ï¼ˆå¯†ç é”™è¯¯ï¼‰

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·å·²æ³¨å†Œ  
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®ç™»å½•é¡µé¢
2. è¾“å…¥é‚®ç®±: `test@example.com`
3. è¾“å…¥å¯†ç : `WrongPassword`
4. ç‚¹å‡»ç™»å½•æŒ‰é’®

**é¢„æœŸç»“æœ:**
- æ˜¾ç¤ºé”™è¯¯: "é‚®ç®±æˆ–å¯†ç é”™è¯¯"
- ä¿æŒåœ¨ç™»å½•é¡µé¢

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.2 AI å¯¹è¯æµ‹è¯•ç”¨ä¾‹

#### TC-CHAT-001: åˆ›å»ºæ–°å¯¹è¯

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·å·²ç™»å½•  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»"æ–°å»ºå¯¹è¯"æŒ‰é’®
2. ç³»ç»Ÿåˆ›å»ºæ–°å¯¹è¯

**é¢„æœŸç»“æœ:**
- å¯¹è¯åˆ›å»ºæˆåŠŸ
- æ˜¾ç¤ºæ–°å¯¹è¯ç•Œé¢
- å¯¹è¯ ID è¿”å›

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-CHAT-002: å‘é€æ¶ˆæ¯å¹¶æ¥æ”¶å›å¤

**å‰ç½®æ¡ä»¶:** å¯¹è¯å·²åˆ›å»º  
**æµ‹è¯•æ­¥éª¤:**
1. è¾“å…¥æ¶ˆæ¯: "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"
2. ç‚¹å‡»å‘é€æŒ‰é’®
3. ç­‰å¾… AI å›å¤

**é¢„æœŸç»“æœ:**
- ç”¨æˆ·æ¶ˆæ¯æ˜¾ç¤ºåœ¨å³ä¾§
- AI å›å¤æµå¼æ˜¾ç¤ºåœ¨å·¦ä¾§
- Markdown æ­£ç¡®æ¸²æŸ“
- Token æ¶ˆè€—æ˜¾ç¤º

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-CHAT-003: å¤šè½®å¯¹è¯

**å‰ç½®æ¡ä»¶:** å¯¹è¯å·²åˆ›å»º  
**æµ‹è¯•æ­¥éª¤:**
1. å‘é€æ¶ˆæ¯: "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"
2. ç­‰å¾… AI å›å¤
3. å‘é€è¿½é—®: "å®ƒæœ‰å“ªäº›åº”ç”¨ï¼Ÿ"
4. ç­‰å¾… AI å›å¤

**é¢„æœŸç»“æœ:**
- AI ç†è§£ä¸Šä¸‹æ–‡
- å›å¤ä¸ä¸Šä¸‹æ–‡ç›¸å…³
- å¯¹è¯å†å²å®Œæ•´ä¿å­˜

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-CHAT-004: æµå¼å“åº”

**å‰ç½®æ¡ä»¶:** å¯¹è¯å·²åˆ›å»º  
**æµ‹è¯•æ­¥éª¤:**
1. å‘é€æ¶ˆæ¯
2. è§‚å¯Ÿ AI å›å¤

**é¢„æœŸç»“æœ:**
- AI å›å¤é€å­—æ˜¾ç¤º
- é¦–å­—å“åº” < 3 ç§’
- å…‰æ ‡é—ªçƒæ•ˆæœ
- æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** å¦ï¼ˆäººå·¥è§‚å¯Ÿï¼‰

---

### 6.3 å¯¹è¯ç®¡ç†æµ‹è¯•ç”¨ä¾‹

#### TC-HISTORY-001: æŸ¥çœ‹å¯¹è¯å†å²

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·æœ‰å¤šä¸ªå¯¹è¯  
**æµ‹è¯•æ­¥éª¤:**
1. è®¿é—®ä¸»é¡µ
2. æŸ¥çœ‹å·¦ä¾§å¯¹è¯åˆ—è¡¨

**é¢„æœŸç»“æœ:**
- å¯¹è¯åˆ—è¡¨æ˜¾ç¤º
- æŒ‰æ—¶é—´å€’åºæ’åˆ—
- å¯¹è¯æ ‡é¢˜å‡†ç¡®
- æ˜¾ç¤ºæ¶ˆæ¯æ•°é‡

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-HISTORY-002: åˆ é™¤å¯¹è¯

**å‰ç½®æ¡ä»¶:** å¯¹è¯å­˜åœ¨  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»å¯¹è¯çš„åˆ é™¤æŒ‰é’®
2. ç¡®è®¤åˆ é™¤

**é¢„æœŸç»“æœ:**
- å¯¹è¯ä»åˆ—è¡¨ä¸­æ¶ˆå¤±
- æ•°æ®åº“ä¸­è®°å½•åˆ é™¤
- ç›¸å…³æ¶ˆæ¯åˆ é™¤

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-HISTORY-003: ç»§ç»­å†å²å¯¹è¯

**å‰ç½®æ¡ä»¶:** å¯¹è¯å­˜åœ¨  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»å†å²å¯¹è¯
2. å‘é€æ–°æ¶ˆæ¯

**é¢„æœŸç»“æœ:**
- å¯¹è¯å†å²åŠ è½½
- æ–°æ¶ˆæ¯æ­£ç¡®å…³è”
- AI ç†è§£å†å²ä¸Šä¸‹æ–‡

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.4 çŸ¥è¯†åº“æµ‹è¯•ç”¨ä¾‹

#### TC-KB-001: ä¸Šä¼  PDF æ–‡æ¡£

**å‰ç½®æ¡ä»¶:** çŸ¥è¯†åº“å·²åˆ›å»º  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»"ä¸Šä¼ æ–‡æ¡£"
2. é€‰æ‹© PDF æ–‡ä»¶ï¼ˆ2MBï¼‰
3. ç­‰å¾…ä¸Šä¼ å®Œæˆ

**é¢„æœŸç»“æœ:**
- ä¸Šä¼ è¿›åº¦æ˜¾ç¤º
- æ–‡æ¡£è§£ææˆåŠŸ
- å‘é‡åŒ–å®Œæˆ
- æ–‡æ¡£å‡ºç°åœ¨åˆ—è¡¨ä¸­

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-KB-002: ä¸Šä¼ è¶…å¤§æ–‡ä»¶

**å‰ç½®æ¡ä»¶:** çŸ¥è¯†åº“å·²åˆ›å»º  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»"ä¸Šä¼ æ–‡æ¡£"
2. é€‰æ‹© 15MB æ–‡ä»¶
3. å°è¯•ä¸Šä¼ 

**é¢„æœŸç»“æœ:**
- æ˜¾ç¤ºé”™è¯¯: "æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ï¼ˆ10MBï¼‰"
- ä¸Šä¼ è¢«æ‹’ç»

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-KB-003: çŸ¥è¯†åº“æ£€ç´¢

**å‰ç½®æ¡ä»¶:** çŸ¥è¯†åº“æœ‰æ–‡æ¡£  
**æµ‹è¯•æ­¥éª¤:**
1. è¾“å…¥æŸ¥è¯¢: "äº§å“ä½¿ç”¨æ–¹æ³•"
2. ç‚¹å‡»æ£€ç´¢æŒ‰é’®

**é¢„æœŸç»“æœ:**
- è¿”å›ç›¸å…³ç»“æœ
- ç›¸å…³æ€§åˆ†æ•°æ˜¾ç¤º
- ç»“æœæŒ‰åˆ†æ•°æ’åº
- å“åº”æ—¶é—´ < 1 ç§’

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-KB-004: åˆ é™¤æ–‡æ¡£

**å‰ç½®æ¡ä»¶:** æ–‡æ¡£å­˜åœ¨  
**æµ‹è¯•æ­¥éª¤:**
1. ç‚¹å‡»æ–‡æ¡£çš„åˆ é™¤æŒ‰é’®
2. ç¡®è®¤åˆ é™¤

**é¢„æœŸç»“æœ:**
- æ–‡æ¡£ä»åˆ—è¡¨ä¸­æ¶ˆå¤±
- å‘é‡æ•°æ®åˆ é™¤
- æ— æ³•å†æ£€ç´¢åˆ°

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.5 ç”¨æˆ·è®¾ç½®æµ‹è¯•ç”¨ä¾‹

#### TC-SETTINGS-001: ä¿®æ”¹ä¸ªäººä¿¡æ¯

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·å·²ç™»å½•  
**æµ‹è¯•æ­¥éª¤:**
1. è¿›å…¥è®¾ç½®é¡µé¢
2. ä¿®æ”¹å§“å: "æ–°åå­—"
3. ç‚¹å‡»ä¿å­˜

**é¢„æœŸç»“æœ:**
- ä¿®æ”¹æˆåŠŸ
- æ˜¾ç¤ºæˆåŠŸæç¤º
- ä¿¡æ¯ç«‹å³æ›´æ–°

**ä¼˜å…ˆçº§:** P1  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-SETTINGS-002: ä¿®æ”¹å¯†ç 

**å‰ç½®æ¡ä»¶:** ç”¨æˆ·å·²ç™»å½•  
**æµ‹è¯•æ­¥éª¤:**
1. è¿›å…¥è®¾ç½®é¡µé¢
2. è¾“å…¥æ—§å¯†ç 
3. è¾“å…¥æ–°å¯†ç 
4. ç‚¹å‡»ä¿å­˜

**é¢„æœŸç»“æœ:**
- ä¿®æ”¹æˆåŠŸ
- æ—§å¯†ç å¤±æ•ˆ
- æ–°å¯†ç å¯ç”¨

**ä¼˜å…ˆçº§:** P1  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.6 æ€§èƒ½æµ‹è¯•ç”¨ä¾‹

#### TC-PERF-001: å¹¶å‘ç”¨æˆ·æµ‹è¯•

**æµ‹è¯•æ­¥éª¤:**
1. æ¨¡æ‹Ÿ 100 ä¸ªå¹¶å‘ç”¨æˆ·
2. åŒæ—¶å‘é€æ¶ˆæ¯

**é¢„æœŸç»“æœ:**
- ç³»ç»Ÿç¨³å®šè¿è¡Œ
- å“åº”æ—¶é—´ < 1 ç§’
- æ— é”™è¯¯å“åº”

**ä¼˜å…ˆçº§:** P1  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-PERF-002: API å“åº”æ—¶é—´

**æµ‹è¯•æ­¥éª¤:**
1. æµ‹è¯•æ‰€æœ‰ API æ¥å£
2. è®°å½•å“åº”æ—¶é—´

**é¢„æœŸç»“æœ:**
- P95 å“åº”æ—¶é—´ < 500ms
- P99 å“åº”æ—¶é—´ < 1s

**ä¼˜å…ˆçº§:** P1  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.7 å®‰å…¨æµ‹è¯•ç”¨ä¾‹

#### TC-SEC-001: SQL æ³¨å…¥æµ‹è¯•

**æµ‹è¯•æ­¥éª¤:**
1. åœ¨è¾“å…¥æ¡†è¾“å…¥ SQL æ³¨å…¥è¯­å¥
2. æäº¤è¯·æ±‚

**é¢„æœŸç»“æœ:**
- ç³»ç»Ÿæ­£ç¡®è½¬ä¹‰
- æ—  SQL æ‰§è¡Œ
- è¿”å›æ­£å¸¸é”™è¯¯

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-SEC-002: XSS æ”»å‡»æµ‹è¯•

**æµ‹è¯•æ­¥éª¤:**
1. åœ¨æ¶ˆæ¯ä¸­è¾“å…¥ JavaScript ä»£ç 
2. å‘é€æ¶ˆæ¯

**é¢„æœŸç»“æœ:**
- ä»£ç è¢«è½¬ä¹‰
- ä¸æ‰§è¡Œè„šæœ¬
- æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

#### TC-SEC-003: æœªæˆæƒè®¿é—®

**æµ‹è¯•æ­¥éª¤:**
1. ä¸æºå¸¦ Token
2. è®¿é—®å—ä¿æŠ¤ API

**é¢„æœŸç»“æœ:**
- è¿”å› 401 é”™è¯¯
- æç¤ºæœªæˆæƒ

**ä¼˜å…ˆçº§:** P0  
**è‡ªåŠ¨åŒ–:** æ˜¯

---

### 6.8 æµ‹è¯•ç”¨ä¾‹æ±‡æ€»

| ç±»åˆ« | ç”¨ä¾‹æ•° | P0 | P1 | P2 |
|------|--------|----|----|----|
| ç”¨æˆ·è®¤è¯ | 5 | 5 | 0 | 0 |
| AI å¯¹è¯ | 4 | 4 | 0 | 0 |
| å¯¹è¯ç®¡ç† | 3 | 3 | 0 | 0 |
| çŸ¥è¯†åº“ | 4 | 4 | 0 | 0 |
| ç”¨æˆ·è®¾ç½® | 2 | 0 | 2 | 0 |
| æ€§èƒ½æµ‹è¯• | 2 | 0 | 2 | 0 |
| å®‰å…¨æµ‹è¯• | 3 | 3 | 0 | 0 |
| **åˆè®¡** | **23** | **19** | **4** | **0** |

---

## 7. éåŠŸèƒ½æ€§éœ€æ±‚

### 7.1 æ€§èƒ½éœ€æ±‚

| æŒ‡æ ‡ | æ ‡å‡† | å¤‡æ³¨ |
|------|------|------|
| é¡µé¢åŠ è½½æ—¶é—´ | < 2 ç§’ | é¦–å±åŠ è½½ |
| API å“åº”æ—¶é—´ | P95 < 500ms | æ‰€æœ‰æ¥å£ |
| AI é¦–å­—å“åº” | < 3 ç§’ | æµå¼å“åº” |
| æ£€ç´¢é€Ÿåº¦ | < 1 ç§’ | çŸ¥è¯†åº“æ£€ç´¢ |
| å¹¶å‘ç”¨æˆ·æ•° | > 100 | MVP é˜¶æ®µ |

---

### 7.2 å¯ç”¨æ€§éœ€æ±‚

| æŒ‡æ ‡ | æ ‡å‡† |
|------|------|
| ç³»ç»Ÿå¯ç”¨æ€§ | 99.5% |
| è®¡åˆ’å†…åœæœº | < 4 å°æ—¶/æœˆ |
| æ•…éšœæ¢å¤æ—¶é—´ | < 30 åˆ†é’Ÿ |

---

### 7.3 å®‰å…¨éœ€æ±‚

| éœ€æ±‚ | è¯´æ˜ |
|------|------|
| æ•°æ®ä¼ è¾“ | HTTPS åŠ å¯† |
| å¯†ç å­˜å‚¨ | bcrypt åŠ å¯† |
| Token è®¤è¯ | JWT + è¿‡æœŸæ—¶é—´ |
| SQL æ³¨å…¥ | å‚æ•°åŒ–æŸ¥è¯¢ |
| XSS é˜²æŠ¤ | è¾“å…¥è½¬ä¹‰ |
| CSRF é˜²æŠ¤ | Token éªŒè¯ |

---

### 7.4 å¯ç»´æŠ¤æ€§éœ€æ±‚

| éœ€æ±‚ | è¯´æ˜ |
|------|------|
| ä»£ç è§„èŒƒ | ESLint/Pylint |
| æµ‹è¯•è¦†ç›–ç‡ | > 70% |
| æ–‡æ¡£å®Œæ•´æ€§ | 100% |
| æ—¥å¿—è®°å½• | å®Œæ•´æ—¥å¿— |
| ç›‘æ§å‘Šè­¦ | Prometheus + Grafana |

---

### 7.5 å…¼å®¹æ€§éœ€æ±‚

**æµè§ˆå™¨æ”¯æŒ:**
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

**è®¾å¤‡æ”¯æŒ:**
- æ¡Œé¢ç«¯ï¼ˆä¼˜å…ˆï¼‰
- ç§»åŠ¨ç«¯ï¼ˆå“åº”å¼ï¼‰

---

## 8. å‘å¸ƒè®¡åˆ’

### 8.1 å‘å¸ƒé‡Œç¨‹ç¢‘

```mermaid
gantt
    title OpenSpark MVP å‘å¸ƒè®¡åˆ’
    dateFormat  YYYY-MM-DD
    section Week 1
    åç«¯å¼€å‘ï¼ˆçŸ¥è¯†åº“ï¼‰     :crit, 2026-02-26, 7d
    section Week 2
    å‰ç«¯å¼€å‘ï¼ˆæ ¸å¿ƒé¡µé¢ï¼‰   :crit, 2026-03-05, 7d
    section Week 3
    å‰ç«¯å¼€å‘ï¼ˆçŸ¥è¯†åº“é¡µé¢ï¼‰ :2026-03-12, 5d
    é›†æˆæµ‹è¯•              :2026-03-12, 5d
    section Week 4
    Bug ä¿®å¤              :2026-03-17, 3d
    æ€§èƒ½ä¼˜åŒ–              :2026-03-17, 3d
    æ­£å¼å‘å¸ƒ              :milestone, 2026-03-20, 0d
```

---

### 8.2 å‘å¸ƒæ£€æŸ¥æ¸…å•

#### 8.2.1 åŠŸèƒ½æ£€æŸ¥

- [ ] æ‰€æœ‰ P0 åŠŸèƒ½å®Œæˆ
- [ ] P1 åŠŸèƒ½å®Œæˆ 80%
- [ ] æ ¸å¿ƒæµç¨‹æµ‹è¯•é€šè¿‡
- [ ] Bug ä¿®å¤å®Œæˆ

#### 8.2.2 æ€§èƒ½æ£€æŸ¥

- [ ] é¡µé¢åŠ è½½ < 2 ç§’
- [ ] API å“åº” < 500ms
- [ ] AI å“åº” < 3 ç§’
- [ ] å¹¶å‘æµ‹è¯•é€šè¿‡

#### 8.2.3 å®‰å…¨æ£€æŸ¥

- [ ] SQL æ³¨å…¥æµ‹è¯•é€šè¿‡
- [ ] XSS æ”»å‡»æµ‹è¯•é€šè¿‡
- [ ] æƒé™éªŒè¯æ­£ç¡®
- [ ] æ•°æ®åŠ å¯†å®Œæˆ

#### 8.2.4 æ–‡æ¡£æ£€æŸ¥

- [ ] API æ–‡æ¡£å®Œæ•´
- [ ] ç”¨æˆ·æ‰‹å†Œå®Œæˆ
- [ ] éƒ¨ç½²æ–‡æ¡£å®Œæˆ
- [ ] è¿ç»´æ–‡æ¡£å®Œæˆ

#### 8.2.5 è¿ç»´æ£€æŸ¥

- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] æ—¥å¿—æ”¶é›†é…ç½®
- [ ] å¤‡ä»½ç­–ç•¥é…ç½®
- [ ] å›æ»šæ–¹æ¡ˆå‡†å¤‡

---

### 8.3 å‘å¸ƒåç›‘æ§

**ç›‘æ§æŒ‡æ ‡:**
- ç”¨æˆ·æ³¨å†Œé‡
- æ—¥æ´»è·ƒç”¨æˆ·ï¼ˆDAUï¼‰
- API è°ƒç”¨é‡
- é”™è¯¯ç‡
- å“åº”æ—¶é—´

**å‘Šè­¦é˜ˆå€¼:**
- é”™è¯¯ç‡ > 1%
- å“åº”æ—¶é—´ > 1s
- å¯ç”¨æ€§ < 99%

---

### 8.4 å›æ»šè®¡åˆ’

**è§¦å‘æ¡ä»¶:**
- P0 Bug æ— æ³•å¿«é€Ÿä¿®å¤
- ç³»ç»Ÿå¯ç”¨æ€§ < 95%
- æ•°æ®ä¸¢å¤±é£é™©

**å›æ»šæ­¥éª¤:**
1. é€šçŸ¥æ‰€æœ‰ç”¨æˆ·
2. åœæ­¢æ–°ç”¨æˆ·æ³¨å†Œ
3. å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
4. ä¿®å¤é—®é¢˜
5. é‡æ–°å‘å¸ƒ

---

## 9. é£é™©ä¸åº”å¯¹

### 9.1 æŠ€æœ¯é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| AI API ä¸ç¨³å®š | ä¸­ | é«˜ | å¤‡ç”¨æ¨¡å‹ã€é™çº§æ–¹æ¡ˆ |
| å‘é‡æ•°æ®åº“æ€§èƒ½ | ä¸­ | ä¸­ | ä¼˜åŒ–ç´¢å¼•ã€ç¼“å­˜ç­–ç•¥ |
| WebSocket è¿æ¥ä¸ç¨³å®š | ä½ | ä¸­ | è‡ªåŠ¨é‡è¿ã€å¿ƒè·³æœºåˆ¶ |
| æ–‡ä»¶ä¸Šä¼ å¤±è´¥ | ä½ | ä½ | é‡è¯•æœºåˆ¶ã€è¿›åº¦ä¿å­˜ |

---

### 9.2 äº§å“é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| ç”¨æˆ·éœ€æ±‚å˜åŒ– | ä¸­ | ä¸­ | å¿«é€Ÿè¿­ä»£ã€ç”¨æˆ·åé¦ˆ |
| ç«å“å‹åŠ› | ä½ | ä¸­ | å·®å¼‚åŒ–åŠŸèƒ½ã€ä¼˜åŒ–ä½“éªŒ |
| æˆæœ¬è¶…æ”¯ | ä¸­ | é«˜ | Token é™åˆ¶ã€æˆæœ¬ç›‘æ§ |

---

### 9.3 èµ„æºé£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| å¼€å‘è¿›åº¦å»¶æœŸ | ä¸­ | ä¸­ | ä¼˜å…ˆçº§ç®¡ç†ã€ç éœ€æ±‚ |
| äººå‘˜ä¸è¶³ | ä½ | é«˜ | å¤–åŒ…ã€ä¸´æ—¶æ”¯æŒ |

---

## 10. é™„å½•

### 10.1 æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| MVP | Minimum Viable Productï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰ |
| RAG | Retrieval-Augmented Generationï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ |
| Token | AI æ¨¡å‹çš„æœ€å°å¤„ç†å•ä½ |
| WebSocket | å…¨åŒå·¥é€šä¿¡åè®® |
| JWT | JSON Web Tokenï¼ˆJSON ä»¤ç‰Œï¼‰ |
| Embedding | å‘é‡åŒ–è¡¨ç¤º |

---

### 10.2 å‚è€ƒæ–‡æ¡£

- [äº§å“å¼€å‘è®¡åˆ’](./PRODUCT_DEVELOPMENT_PLAN.md)
- [æ¶æ„æ¼”è¿›è·¯çº¿å›¾](./ARCHITECTURE_ROADMAP.md)
- [æ•°æ®åº“è®¾è®¡](./database-design.md)
- [API æ–‡æ¡£](../claw-ai-backend/README.md)

---

### 10.3 å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| v1.0 | 2026-02-26 | åˆå§‹ç‰ˆæœ¬ | äº§å“ç»ç† |

---

**æ–‡æ¡£ç»“æŸ**

*æœ¬æ–‡æ¡£ä¸º OpenSpark MVP äº§å“éœ€æ±‚æ–‡æ¡£ï¼Œåç»­å°†æ ¹æ®å¼€å‘è¿›å±•å’Œç”¨æˆ·åé¦ˆæŒç»­æ›´æ–°ã€‚*
