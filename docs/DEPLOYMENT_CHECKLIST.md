# 部署检查清单

本文档提供 CLAW.AI 前后端部署的完整检查清单，确保部署成功。

---

## 📋 后端部署检查

### 1. 环境准备

- [ ] Python 3.11+ 已安装
- [ ] PostgreSQL 15+ 已安装并运行
- [ ] Redis 7+ 已安装并运行
- [ ] Qdrant 已安装并运行（可选 Docker）
- [ ] 智谱 AI API Key 已获取

### 2. 配置文件

- [ ] `.env` 文件已创建
- [ ] `DATABASE_URL` 已正确配置
- [ ] `REDIS_URL` 已正确配置
- [ ] `ZHIPUAI_API_KEY` 已配置
- [ ] `QDRANT_HOST` 和 `QDRANT_PORT` 已配置
- [ ] `SECRET_KEY` 已设置（生产环境）
- [ ] `DEBUG=False`（生产环境）

### 3. 依赖安装

- [ ] Python 虚拟环境已创建
- [ ] `requirements.txt` 依赖已安装
- [ ] 无依赖冲突错误

### 4. 数据库

- [ ] PostgreSQL 服务运行正常
- [ ] 数据库 `claw_ai` 已创建
- [ ] 数据库迁移已执行（`alembic upgrade head`）
- [ ] 表结构创建成功

### 5. 依赖服务

#### Qdrant
- [ ] Qdrant 服务运行正常
- [ ] 可访问 `http://localhost:6333`
- [ ] `/health` 端点返回正常
- [ ] 向量集合已创建

#### Redis
- [ ] Redis 服务运行正常
- [ ] 可连接 `localhost:6379`
- [ ] `PING` 命令返回 `PONG`

### 6. 应用启动

- [ ] 后端服务启动成功
- [ ] 日志无严重错误
- [ ] `/health` 端点返回 200
- [ ] `/docs` 端点可访问

### 7. 功能测试

#### 认证功能
- [ ] 用户注册接口正常
- [ ] 用户登录接口正常
- [ ] Token 刷新正常
- [ ] 登出功能正常

#### 知识库功能
- [ ] 创建知识库正常
- [ ] 获取知识库列表正常
- [ ] 上传文档正常
- [ ] 文档解析正常
- [ ] RAG 查询正常

#### 对话功能
- [ ] 创建对话正常
- [ ] 发送消息正常
- [ ] 获取消息列表正常
- [ ] WebSocket 连接正常

### 8. 安全检查

- [ ] 生产环境 `DEBUG=False`
- [ ] `SECRET_KEY` 已更改为随机值
- [ ] CORS 配置正确
- [ ] HTTPS 已启用（生产环境）
- [ ] 数据库密码已修改
- [ ] Redis 密码已配置（生产环境）

---

## 📋 前端部署检查

### 1. 环境准备

- [ ] Node.js 18+ 已安装
- [ ] npm 已安装
- [ ] 后端服务已启动

### 2. 配置文件

- [ ] `.env` 文件已创建
- [ ] `VITE_API_BASE_URL` 已配置
- [ ] 生产环境使用完整 URL
- [ ] `VITE_WS_URL` 已配置

### 3. 依赖安装

- [ ] `node_modules` 已安装
- [ ] 无依赖冲突错误
- [ ] `zod` 依赖已安装

### 4. 构建测试

- [ ] `npm run build` 成功
- [ ] 构建产物生成正常
- [ ] 无构建错误

### 5. 开发服务器

- [ ] `npm run dev` 启动成功
- [ ] 运行在 `http://localhost:3000`
- [ ] 无编译错误

### 6. 代理配置

- [ ] Vite 代理配置正确
- [ ] `/api` 请求正确转发到后端
- [ ] `/ws` WebSocket 连接正常

### 7. 功能测试

#### 页面加载
- [ ] 首页加载正常
- [ ] 登录页加载正常
- [ ] 注册页加载正常
- [ ] 主界面加载正常

#### 用户功能
- [ ] 用户注册流程正常
- [ ] 用户登录流程正常
- [ ] 登录后跳转正确
- [ ] 登出功能正常

#### 知识库功能
- [ ] 知识库列表显示正常
- [ ] 创建知识库功能正常
- [ ] 上传文档功能正常
- [ ] 文档列表显示正常
- [ ] 删除文档功能正常

#### 对话功能
- [ ] 对话列表显示正常
- [ ] 创建对话功能正常
- [ ] 发送消息功能正常
- [ ] 接收消息功能正常
- [ ] WebSocket 实时更新正常

### 8. 样式和响应式

- [ ] 样式加载正常
- [ ] 图标显示正常
- [ ] 桌面端显示正常
- [ ] 平板端显示正常
- [ ] 移动端显示正常

### 9. 错误处理

- [ ] 网络错误提示正常
- [ ] 服务器错误提示正常
- [ ] 表单验证错误提示正常
- [ ] 加载状态显示正常

---

## 📋 集成测试

### 1. 前后端联调

- [ ] 注册流程完整测试
- [ ] 登录流程完整测试
- [ ] 知识库创建和上传测试
- [ ] RAG 查询测试
- [ ] 对话创建和消息测试

### 2. WebSocket 测试

- [ ] WebSocket 连接建立
- [ ] 实时消息发送
- [ ] 实时消息接收
- [ ] 断线重连测试
- [ ] 多客户端测试

### 3. 文件上传测试

- [ ] TXT 文件上传
- [ ] Markdown 文件上传
- [ ] PDF 文件上传
- [ ] 大文件上传
- [ ] 上传进度显示

---

## 📋 性能测试

### 1. 后端性能

- [ ] API 响应时间 < 500ms
- [ ] 支持 100+ 并发请求
- [ ] 数据库查询优化
- [ ] 缓存命中率 > 80%

### 2. 前端性能

- [ ] 首屏加载时间 < 2s
- [ ] 页面切换流畅
- [ ] 无内存泄漏
- [ ] 无明显卡顿

---

## 📋 生产环境检查

### 1. 域名和 HTTPS

- [ ] 域名已解析
- [ ] SSL 证书已配置
- [ ] HTTPS 可访问
- [ ] HTTP 自动跳转 HTTPS

### 2. 反向代理

- [ ] Nginx 已配置
- [ ] 前端路由正确
- [ ] 后端 API 代理正确
- [ ] WebSocket 代理正确

### 3. 数据库备份

- [ ] 数据库备份策略已配置
- [ ] 自动备份正常运行
- [ ] 备份恢复测试通过

### 4. 日志和监控

- [ ] 日志记录正常
- [ ] 日志轮转已配置
- [ ] 错误告警已配置
- [ ] 性能监控已配置

### 5. 安全配置

- [ ] 防火墙已配置
- [ ] 端口只开放必要端口
- [ ] SSH 密钥登录已配置
- [ ] 系统自动更新已配置

---

## 📋 文档检查

- [ ] API 文档完整
- [ ] 部署文档完整
- [ ] 开发环境搭建文档完整
- [ ] 用户使用文档完整
- [ ] 故障排查文档完整

---

## 📋 代码质量

### 1. 后端

- [ ] 代码格式化完成
- [ ] Lint 检查通过
- [ ] 单元测试覆盖率 > 80%
- [ ] 无严重 Bug

### 2. 前端

- [ ] 代码格式化完成
- [ ] Lint 检查通过
- [ ] TypeScript 类型检查通过
- [ ] 无控制台错误

---

## ✅ 部署成功标准

### 最小可用产品（MVP）

- [x] 用户可以注册和登录
- [x] 用户可以创建知识库
- [x] 用户可以上传文档
- [x] 用户可以进行 RAG 查询
- [x] 用户可以创建对话并发送消息
- [x] WebSocket 实时通信正常

### 生产环境

- [x] 所有功能正常
- [x] 性能达标
- [x] 安全配置完成
- [x] 监控和日志完整
- [x] 备份策略完善

---

**文档更新日期：** 2026-02-26
**负责人：** CEO OpenClaw
